<!DOCTYPE html>
<html>
<head>
  <title>CronCraft Jobs</title>
  <script src="https://unpkg.com/htmx.org@1.9.3"></script>
</head>
<body>
  <h1>CronCraft Jobs</h1>

  <h2>Add Job</h2>
  <form hx-post="/add" hx-target="#job-list" hx-swap="innerHTML">
    Name: <input type="text" name="name" required>
    Schedule: <input type="text" name="schedule" required>
    Command: <input type="text" name="command" required>
    <button type="submit">Add Job</button>
  </form>

  <h2>Jobs</h2>
  <div id="job-list">
    {{template "jobTable" .Jobs}}
  </div>

  <!-- Job Table Template -->
  {{define "jobTable"}}
  <table border="1">
    <tr><th>ID</th><th>Name</th><th>Schedule</th><th>Command</th><th>Actions</th></tr>
    {{range .}}
      <tr id="job-{{.ID}}">
        <td>{{.ID}}</td>
        <td>{{.Name}}</td>
        <td>{{.Schedule}}</td>
        <td>{{.Command}}</td>
        <td>
          <button hx-post="/run/{{.ID}}" hx-target="#output-{{.ID}}" hx-swap="innerHTML">Run Now</button>
          <form style="display:inline;" hx-post="/delete/{{.ID}}" hx-target="#job-list" hx-swap="innerHTML">
            <button onclick="return confirm('Delete this job?');">Delete</button>
          </form>
          <a href="/logs/{{.ID}}">View Logs</a>
          <div id="output-{{.ID}}"></div>
        </td>
      </tr>
    {{end}}
  </table>
  {{end}}
</body>
</html>
